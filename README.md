Copy pasta torch code from PyTorch official tutorial with minor modification from me.
